{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\POOJA\\\\bookk\\\\src\\\\context\\\\auth.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport React from \"react\";\nimport Shared from \"../utils/shared\";\nimport { RoutePaths } from \"../utils/enum\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst intialUserValue = {\n  id: 0,\n  email: \"\",\n  firstName: \"\",\n  lastName: \"\",\n  roleId: 0,\n  role: \"\",\n  password: \"\"\n};\nconst initialState = {\n  setUser: () => {},\n  user: intialUserValue,\n  signOut: () => {},\n  appInitialize: false\n};\nexport const AuthContext = /*#__PURE__*/createContext(initialState);\nexport const AuthWrapper = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [appInitialize, setAppInitialize] = useState(false);\n  const [user, _setUser] = useState(intialUserValue);\n  const navigate = useNavigate();\n  const {\n    pathname\n  } = useLocation();\n  const setUser = user => {\n    console.log(\"bruce@wayne2.com\", user);\n    localStorage.setItem(Shared.LocalStorageKeys.USER, JSON.stringify(user));\n    _setUser(user);\n  };\n  useEffect(() => {\n    const itemStr = JSON.parse(localStorage.getItem(Shared.LocalStorageKeys.USER)) || intialUserValue;\n    // if the item doesn't exist, return null\n    if (!itemStr.id) {\n      navigate(`${RoutePaths.Login}`);\n    }\n    _setUser(itemStr);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const signOut = () => {\n    setUser(intialUserValue);\n    localStorage.removeItem(Shared.LocalStorageKeys.USER);\n    navigate(`${RoutePaths.Login}`);\n  };\n  useEffect(() => {\n    if (pathname === RoutePaths.Login && user.id) {\n      navigate(RoutePaths.BookListing);\n    }\n    if (!user.id) {\n      return;\n    }\n    const access = Shared.hasAccess(pathname, user);\n    if (!access) {\n      toast.warning(\"Sorry, you are not authorized to access this page\");\n      navigate(RoutePaths.BookListing);\n      return;\n    }\n    setAppInitialize(true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [pathname, user]);\n  let value = {\n    user,\n    setUser,\n    signOut,\n    appInitialize\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 10\n  }, this);\n};\n_s(AuthWrapper, \"Ojppp0iJnmEiMJRzP37UQOhIHWE=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = AuthWrapper;\nexport const useAuthContext = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuthContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthWrapper\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","React","Shared","RoutePaths","useNavigate","useLocation","toast","jsxDEV","_jsxDEV","intialUserValue","id","email","firstName","lastName","roleId","role","password","initialState","setUser","user","signOut","appInitialize","AuthContext","AuthWrapper","_ref","_s","children","setAppInitialize","_setUser","navigate","pathname","console","log","localStorage","setItem","LocalStorageKeys","USER","JSON","stringify","itemStr","parse","getItem","Login","removeItem","BookListing","access","hasAccess","warning","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuthContext","_s2","$RefreshReg$"],"sources":["C:/Users/POOJA/bookk/src/context/auth.jsx"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\r\nimport React from \"react\";\r\nimport Shared from \"../utils/shared\";\r\nimport { RoutePaths } from \"../utils/enum\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst intialUserValue = {\r\n  id: 0,\r\n  email: \"\",\r\n  firstName: \"\",\r\n  lastName: \"\",\r\n  roleId: 0,\r\n  role: \"\",\r\n  password: \"\",\r\n};\r\n\r\nconst initialState = {\r\n  setUser: () => {},\r\n  user: intialUserValue,\r\n  signOut: () => {},\r\n  appInitialize: false,\r\n};\r\n\r\nexport const AuthContext = createContext(initialState);\r\n\r\nexport const AuthWrapper = ({ children }) => {\r\n  const [appInitialize, setAppInitialize] = useState(false);\r\n  const [user, _setUser] = useState(intialUserValue);\r\n\r\n  const navigate = useNavigate();\r\n  const { pathname } = useLocation();\r\n\r\n  const setUser = (user) => {\r\n    console.log(\"bruce@wayne2.com\", user);\r\n    localStorage.setItem(Shared.LocalStorageKeys.USER, JSON.stringify(user));\r\n    _setUser(user);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const itemStr =\r\n      JSON.parse(localStorage.getItem(Shared.LocalStorageKeys.USER)) ||\r\n      intialUserValue;\r\n    // if the item doesn't exist, return null\r\n    if (!itemStr.id) {\r\n      navigate(`${RoutePaths.Login}`);\r\n    }\r\n    _setUser(itemStr);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const signOut = () => {\r\n    setUser(intialUserValue);\r\n    localStorage.removeItem(Shared.LocalStorageKeys.USER);\r\n    navigate(`${RoutePaths.Login}`);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (pathname === RoutePaths.Login && user.id) {\r\n      navigate(RoutePaths.BookListing);\r\n    }\r\n\r\n    if (!user.id) {\r\n      return;\r\n    }\r\n    const access = Shared.hasAccess(pathname, user);\r\n    if (!access) {\r\n      toast.warning(\"Sorry, you are not authorized to access this page\");\r\n      navigate(RoutePaths.BookListing);\r\n      return;\r\n    }\r\n    setAppInitialize(true);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [pathname, user]);\r\n\r\n  let value = {\r\n    user,\r\n    setUser,\r\n    signOut,\r\n    appInitialize,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\nexport const useAuthContext = () => {\r\n  return useContext(AuthContext);\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}